{"ast":null,"code":"/**\n * Copyright (c) 2010,2011,2012,2013,2014 Morgan Roderick http://roderick.dk\n * License: MIT - http://mrgnrdrck.mit-license.org\n *\n * https://github.com/mroderick/PubSubJS\n */\n(function (root, factory) {\n  'use strict';\n\n  var PubSub = {};\n  root.PubSub = PubSub;\n  var define = root.define;\n  factory(PubSub); // AMD support\n\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return PubSub;\n    }); // CommonJS and Node.js module support\n  } else if (typeof exports === 'object') {\n    if (module !== undefined && module.exports) {\n      exports = module.exports = PubSub; // Node.js specific `module.exports`\n    }\n\n    exports.PubSub = PubSub; // CommonJS module 1.1.1 spec\n\n    module.exports = exports = PubSub; // CommonJS\n  }\n})(typeof window === 'object' && window || this, function (PubSub) {\n  'use strict';\n\n  var messages = {},\n      lastUid = -1;\n\n  function hasKeys(obj) {\n    var key;\n\n    for (key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n  /**\n   * Returns a function that throws the passed exception, for use as argument for setTimeout\n   * @alias throwException\n   * @function\n   * @param { Object } ex An Error object\n   */\n\n\n  function throwException(ex) {\n    return function reThrowException() {\n      throw ex;\n    };\n  }\n\n  function callSubscriberWithDelayedExceptions(subscriber, message, data) {\n    try {\n      subscriber(message, data);\n    } catch (ex) {\n      setTimeout(throwException(ex), 0);\n    }\n  }\n\n  function callSubscriberWithImmediateExceptions(subscriber, message, data) {\n    subscriber(message, data);\n  }\n\n  function deliverMessage(originalMessage, matchedMessage, data, immediateExceptions) {\n    var subscribers = messages[matchedMessage],\n        callSubscriber = immediateExceptions ? callSubscriberWithImmediateExceptions : callSubscriberWithDelayedExceptions,\n        s;\n\n    if (!messages.hasOwnProperty(matchedMessage)) {\n      return;\n    }\n\n    for (s in subscribers) {\n      if (subscribers.hasOwnProperty(s)) {\n        callSubscriber(subscribers[s], originalMessage, data);\n      }\n    }\n  }\n\n  function createDeliveryFunction(message, data, immediateExceptions) {\n    return function deliverNamespaced() {\n      var topic = String(message),\n          position = topic.lastIndexOf('.'); // deliver the message as it is now\n\n      deliverMessage(message, message, data, immediateExceptions); // trim the hierarchy and deliver message to each level\n\n      while (position !== -1) {\n        topic = topic.substr(0, position);\n        position = topic.lastIndexOf('.');\n        deliverMessage(message, topic, data, immediateExceptions);\n      }\n    };\n  }\n\n  function messageHasSubscribers(message) {\n    var topic = String(message),\n        found = Boolean(messages.hasOwnProperty(topic) && hasKeys(messages[topic])),\n        position = topic.lastIndexOf('.');\n\n    while (!found && position !== -1) {\n      topic = topic.substr(0, position);\n      position = topic.lastIndexOf('.');\n      found = Boolean(messages.hasOwnProperty(topic) && hasKeys(messages[topic]));\n    }\n\n    return found;\n  }\n\n  function publish(message, data, sync, immediateExceptions) {\n    message = typeof message === 'symbol' ? message.toString() : message;\n    var deliver = createDeliveryFunction(message, data, immediateExceptions),\n        hasSubscribers = messageHasSubscribers(message);\n\n    if (!hasSubscribers) {\n      return false;\n    }\n\n    if (sync === true) {\n      deliver();\n    } else {\n      setTimeout(deliver, 0);\n    }\n\n    return true;\n  }\n  /**\n   * Publishes the message, passing the data to it's subscribers\n   * @function\n   * @alias publish\n   * @param { String } message The message to publish\n   * @param {} data The data to pass to subscribers\n   * @return { Boolean }\n   */\n\n\n  PubSub.publish = function (message, data) {\n    return publish(message, data, false, PubSub.immediateExceptions);\n  };\n  /**\n   * Publishes the message synchronously, passing the data to it's subscribers\n   * @function\n   * @alias publishSync\n   * @param { String } message The message to publish\n   * @param {} data The data to pass to subscribers\n   * @return { Boolean }\n   */\n\n\n  PubSub.publishSync = function (message, data) {\n    return publish(message, data, true, PubSub.immediateExceptions);\n  };\n  /**\n   * Subscribes the passed function to the passed message. Every returned token is unique and should be stored if you need to unsubscribe\n   * @function\n   * @alias subscribe\n   * @param { String } message The message to subscribe to\n   * @param { Function } func The function to call when a new message is published\n   * @return { String }\n   */\n\n\n  PubSub.subscribe = function (message, func) {\n    if (typeof func !== 'function') {\n      return false;\n    }\n\n    message = typeof message === 'symbol' ? message.toString() : message; // message is not registered yet\n\n    if (!messages.hasOwnProperty(message)) {\n      messages[message] = {};\n    } // forcing token as String, to allow for future expansions without breaking usage\n    // and allow for easy use as key names for the 'messages' object\n\n\n    var token = 'uid_' + String(++lastUid);\n    messages[message][token] = func; // return token for unsubscribing\n\n    return token;\n  };\n  /**\n   * Subscribes the passed function to the passed message once\n   * @function\n   * @alias subscribeOnce\n   * @param { String } message The message to subscribe to\n   * @param { Function } func The function to call when a new message is published\n   * @return { PubSub }\n   */\n\n\n  PubSub.subscribeOnce = function (message, func) {\n    var token = PubSub.subscribe(message, function () {\n      // before func apply, unsubscribe message\n      PubSub.unsubscribe(token);\n      func.apply(this, arguments);\n    });\n    return PubSub;\n  };\n  /**\n   * Clears all subscriptions\n   * @function\n   * @public\n   * @alias clearAllSubscriptions\n   */\n\n\n  PubSub.clearAllSubscriptions = function clearAllSubscriptions() {\n    messages = {};\n  };\n  /**\n   * Clear subscriptions by the topic\n   * @function\n   * @public\n   * @alias clearAllSubscriptions\n   * @return { int }\n   */\n\n\n  PubSub.clearSubscriptions = function clearSubscriptions(topic) {\n    var m;\n\n    for (m in messages) {\n      if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0) {\n        delete messages[m];\n      }\n    }\n  };\n  /** \n     Count subscriptions by the topic\n   * @function\n   * @public\n   * @alias countSubscriptions\n   * @return { Array }\n  */\n\n\n  PubSub.countSubscriptions = function countSubscriptions(topic) {\n    var m;\n    var count = 0;\n\n    for (m in messages) {\n      if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0) {\n        count++;\n      }\n    }\n\n    return count;\n  };\n  /** \n     Gets subscriptions by the topic\n   * @function\n   * @public\n   * @alias getSubscriptions\n  */\n\n\n  PubSub.getSubscriptions = function getSubscriptions(topic) {\n    var m;\n    var list = [];\n\n    for (m in messages) {\n      if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0) {\n        list.push(m);\n      }\n    }\n\n    return list;\n  };\n  /**\n   * Removes subscriptions\n   *\n   * - When passed a token, removes a specific subscription.\n   *\n  * - When passed a function, removes all subscriptions for that function\n   *\n  * - When passed a topic, removes all subscriptions for that topic (hierarchy)\n   * @function\n   * @public\n   * @alias subscribeOnce\n   * @param { String | Function } value A token, function or topic to unsubscribe from\n   * @example // Unsubscribing with a token\n   * var token = PubSub.subscribe('mytopic', myFunc);\n   * PubSub.unsubscribe(token);\n   * @example // Unsubscribing with a function\n   * PubSub.unsubscribe(myFunc);\n   * @example // Unsubscribing from a topic\n   * PubSub.unsubscribe('mytopic');\n   */\n\n\n  PubSub.unsubscribe = function (value) {\n    var descendantTopicExists = function (topic) {\n      var m;\n\n      for (m in messages) {\n        if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0) {\n          // a descendant of the topic exists:\n          return true;\n        }\n      }\n\n      return false;\n    },\n        isTopic = typeof value === 'string' && (messages.hasOwnProperty(value) || descendantTopicExists(value)),\n        isToken = !isTopic && typeof value === 'string',\n        isFunction = typeof value === 'function',\n        result = false,\n        m,\n        message,\n        t;\n\n    if (isTopic) {\n      PubSub.clearSubscriptions(value);\n      return;\n    }\n\n    for (m in messages) {\n      if (messages.hasOwnProperty(m)) {\n        message = messages[m];\n\n        if (isToken && message[value]) {\n          delete message[value];\n          result = value; // tokens are unique, so we can just stop here\n\n          break;\n        }\n\n        if (isFunction) {\n          for (t in message) {\n            if (message.hasOwnProperty(t) && message[t] === value) {\n              delete message[t];\n              result = true;\n            }\n          }\n        }\n      }\n    }\n\n    return result;\n  };\n});","map":{"version":3,"sources":["/Users/mr.bo/项目/React/react-im/node_modules/pubsub-js/src/pubsub.js"],"names":["root","factory","PubSub","define","amd","exports","module","undefined","window","messages","lastUid","hasKeys","obj","key","hasOwnProperty","throwException","ex","reThrowException","callSubscriberWithDelayedExceptions","subscriber","message","data","setTimeout","callSubscriberWithImmediateExceptions","deliverMessage","originalMessage","matchedMessage","immediateExceptions","subscribers","callSubscriber","s","createDeliveryFunction","deliverNamespaced","topic","String","position","lastIndexOf","substr","messageHasSubscribers","found","Boolean","publish","sync","toString","deliver","hasSubscribers","publishSync","subscribe","func","token","subscribeOnce","unsubscribe","apply","arguments","clearAllSubscriptions","clearSubscriptions","m","indexOf","countSubscriptions","count","getSubscriptions","list","push","value","descendantTopicExists","isTopic","isToken","isFunction","result","t"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2010,2011,2012,2013,2014 Morgan Roderick http://roderick.dk\n * License: MIT - http://mrgnrdrck.mit-license.org\n *\n * https://github.com/mroderick/PubSubJS\n */\n\n(function (root, factory){\n    'use strict';\n\n    var PubSub = {};\n    root.PubSub = PubSub;\n\n    var define = root.define;\n\n    factory(PubSub);\n\n    // AMD support\n    if (typeof define === 'function' && define.amd){\n        define(function() { return PubSub; });\n\n        // CommonJS and Node.js module support\n    } else if (typeof exports === 'object'){\n        if (module !== undefined && module.exports) {\n            exports = module.exports = PubSub; // Node.js specific `module.exports`\n        }\n        exports.PubSub = PubSub; // CommonJS module 1.1.1 spec\n        module.exports = exports = PubSub; // CommonJS\n    }\n\n}(( typeof window === 'object' && window ) || this, function (PubSub){\n    'use strict';\n\n    var messages = {},\n        lastUid = -1;\n\n    function hasKeys(obj){\n        var key;\n\n        for (key in obj){\n            if ( obj.hasOwnProperty(key) ){\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * Returns a function that throws the passed exception, for use as argument for setTimeout\n     * @alias throwException\n     * @function\n     * @param { Object } ex An Error object\n     */\n    function throwException( ex ){\n        return function reThrowException(){\n            throw ex;\n        };\n    }\n\n    function callSubscriberWithDelayedExceptions( subscriber, message, data ){\n        try {\n            subscriber( message, data );\n        } catch( ex ){\n            setTimeout( throwException( ex ), 0);\n        }\n    }\n\n    function callSubscriberWithImmediateExceptions( subscriber, message, data ){\n        subscriber( message, data );\n    }\n\n    function deliverMessage( originalMessage, matchedMessage, data, immediateExceptions ){\n        var subscribers = messages[matchedMessage],\n            callSubscriber = immediateExceptions ? callSubscriberWithImmediateExceptions : callSubscriberWithDelayedExceptions,\n            s;\n\n        if ( !messages.hasOwnProperty( matchedMessage ) ) {\n            return;\n        }\n\n        for (s in subscribers){\n            if ( subscribers.hasOwnProperty(s)){\n                callSubscriber( subscribers[s], originalMessage, data );\n            }\n        }\n    }\n\n    function createDeliveryFunction( message, data, immediateExceptions ){\n        return function deliverNamespaced(){\n            var topic = String( message ),\n                position = topic.lastIndexOf( '.' );\n\n            // deliver the message as it is now\n            deliverMessage(message, message, data, immediateExceptions);\n\n            // trim the hierarchy and deliver message to each level\n            while( position !== -1 ){\n                topic = topic.substr( 0, position );\n                position = topic.lastIndexOf('.');\n                deliverMessage( message, topic, data, immediateExceptions );\n            }\n        };\n    }\n\n    function messageHasSubscribers( message ){\n        var topic = String( message ),\n            found = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic])),\n            position = topic.lastIndexOf( '.' );\n\n        while ( !found && position !== -1 ){\n            topic = topic.substr( 0, position );\n            position = topic.lastIndexOf( '.' );\n            found = Boolean(messages.hasOwnProperty( topic ) && hasKeys(messages[topic]));\n        }\n\n        return found;\n    }\n\n    function publish( message, data, sync, immediateExceptions ){\n        message = (typeof message === 'symbol') ? message.toString() : message;\n\n        var deliver = createDeliveryFunction( message, data, immediateExceptions ),\n            hasSubscribers = messageHasSubscribers( message );\n\n        if ( !hasSubscribers ){\n            return false;\n        }\n\n        if ( sync === true ){\n            deliver();\n        } else {\n            setTimeout( deliver, 0 );\n        }\n        return true;\n    }\n\n    /**\n     * Publishes the message, passing the data to it's subscribers\n     * @function\n     * @alias publish\n     * @param { String } message The message to publish\n     * @param {} data The data to pass to subscribers\n     * @return { Boolean }\n     */\n    PubSub.publish = function( message, data ){\n        return publish( message, data, false, PubSub.immediateExceptions );\n    };\n\n    /**\n     * Publishes the message synchronously, passing the data to it's subscribers\n     * @function\n     * @alias publishSync\n     * @param { String } message The message to publish\n     * @param {} data The data to pass to subscribers\n     * @return { Boolean }\n     */\n    PubSub.publishSync = function( message, data ){\n        return publish( message, data, true, PubSub.immediateExceptions );\n    };\n\n    /**\n     * Subscribes the passed function to the passed message. Every returned token is unique and should be stored if you need to unsubscribe\n     * @function\n     * @alias subscribe\n     * @param { String } message The message to subscribe to\n     * @param { Function } func The function to call when a new message is published\n     * @return { String }\n     */\n    PubSub.subscribe = function( message, func ){\n        if ( typeof func !== 'function'){\n            return false;\n        }\n\n        message = (typeof message === 'symbol') ? message.toString() : message;\n\n        // message is not registered yet\n        if ( !messages.hasOwnProperty( message ) ){\n            messages[message] = {};\n        }\n\n        // forcing token as String, to allow for future expansions without breaking usage\n        // and allow for easy use as key names for the 'messages' object\n        var token = 'uid_' + String(++lastUid);\n        messages[message][token] = func;\n        \n        // return token for unsubscribing\n        return token;\n    };\n\n    /**\n     * Subscribes the passed function to the passed message once\n     * @function\n     * @alias subscribeOnce\n     * @param { String } message The message to subscribe to\n     * @param { Function } func The function to call when a new message is published\n     * @return { PubSub }\n     */\n    PubSub.subscribeOnce = function( message, func ){\n        var token = PubSub.subscribe( message, function(){\n            // before func apply, unsubscribe message\n            PubSub.unsubscribe( token );\n            func.apply( this, arguments );\n        });\n        return PubSub;\n    };\n\n    /**\n     * Clears all subscriptions\n     * @function\n     * @public\n     * @alias clearAllSubscriptions\n     */\n    PubSub.clearAllSubscriptions = function clearAllSubscriptions(){\n        messages = {};\n    };\n\n    /**\n     * Clear subscriptions by the topic\n     * @function\n     * @public\n     * @alias clearAllSubscriptions\n     * @return { int }\n     */\n    PubSub.clearSubscriptions = function clearSubscriptions(topic){\n        var m;\n        for (m in messages){\n            if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0){\n                delete messages[m];\n            }\n        }\n    };\n\n    /** \n       Count subscriptions by the topic\n     * @function\n     * @public\n     * @alias countSubscriptions\n     * @return { Array }\n    */\n    PubSub.countSubscriptions = function countSubscriptions(topic){\n        var m;\n        var count = 0;\n        for (m in messages){\n            if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0){\n                count++;\n            }\n        }\n        return count;\n    };\n\n    \n    /** \n       Gets subscriptions by the topic\n     * @function\n     * @public\n     * @alias getSubscriptions\n    */\n    PubSub.getSubscriptions = function getSubscriptions(topic){\n        var m;\n        var list = [];\n        for (m in messages){\n            if (messages.hasOwnProperty(m) && m.indexOf(topic) === 0){\n                list.push(m);\n            }\n        }\n        return list;\n    };\n\n    /**\n     * Removes subscriptions\n     *\n     * - When passed a token, removes a specific subscription.\n     *\n\t * - When passed a function, removes all subscriptions for that function\n     *\n\t * - When passed a topic, removes all subscriptions for that topic (hierarchy)\n     * @function\n     * @public\n     * @alias subscribeOnce\n     * @param { String | Function } value A token, function or topic to unsubscribe from\n     * @example // Unsubscribing with a token\n     * var token = PubSub.subscribe('mytopic', myFunc);\n     * PubSub.unsubscribe(token);\n     * @example // Unsubscribing with a function\n     * PubSub.unsubscribe(myFunc);\n     * @example // Unsubscribing from a topic\n     * PubSub.unsubscribe('mytopic');\n     */\n    PubSub.unsubscribe = function(value){\n        var descendantTopicExists = function(topic) {\n                var m;\n                for ( m in messages ){\n                    if ( messages.hasOwnProperty(m) && m.indexOf(topic) === 0 ){\n                        // a descendant of the topic exists:\n                        return true;\n                    }\n                }\n\n                return false;\n            },\n            isTopic    = typeof value === 'string' && ( messages.hasOwnProperty(value) || descendantTopicExists(value) ),\n            isToken    = !isTopic && typeof value === 'string',\n            isFunction = typeof value === 'function',\n            result = false,\n            m, message, t;\n\n        if (isTopic){\n            PubSub.clearSubscriptions(value);\n            return;\n        }\n\n        for ( m in messages ){\n            if ( messages.hasOwnProperty( m ) ){\n                message = messages[m];\n\n                if ( isToken && message[value] ){\n                    delete message[value];\n                    result = value;\n                    // tokens are unique, so we can just stop here\n                    break;\n                }\n\n                if (isFunction) {\n                    for ( t in message ){\n                        if (message.hasOwnProperty(t) && message[t] === value){\n                            delete message[t];\n                            result = true;\n                        }\n                    }\n                }\n            }\n        }\n\n        return result;\n    };\n}));\n"]},"metadata":{},"sourceType":"script"}